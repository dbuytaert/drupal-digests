# #3564710: Add a `--generic` option to `drush config:export`

- **Project:** Drupal CMS
- **Type:** Normal feature request
- **Status:** Fixed
- **Diff:** [22d5dd3](https://git.drupalcode.org/project/drupal_cms/-/commit/22d5dd386f93fdc25ffa139fbe22956b0a6714a2) · +316/-190 prod · +134/-0 test · 16 files
- **Discussion:** [#3564710](https://www.drupal.org/node/3564710) · 1 contributor · 6 comments

## Summary

When exporting configuration to create a recipe or site template, you previously had to manually remove `uuid` and `_core` keys from the exported files. This is tedious and easy to forget. The `drupal_cms_helper` module now provides a `--generic` option for the `drush config:export` command that automatically strips these keys, making exported configuration ready to use in recipes without manual cleanup.

## Impact

No upgrade or configuration changes required.

## Technical details

The `drupal_cms_helper` module adds a `--generic` option to Drush's `config:export` command. When this flag is set, a new `ConfigExportCommandListener` class hooks into Drush's console events to register a `GenericConfigurationListener` with the `ConfigEvents::STORAGE_TRANSFORM_EXPORT` event.

The `GenericConfigurationListener` processes each exported configuration object and removes the `_core` key universally. For the `uuid` key, it uses logic from `EntityTypeManagerInterface` to determine whether the UUID should be kept. UUIDs are preserved only when they serve as the entity ID (like Canvas folders), but removed in all other cases including simple configuration and standard config entities.

The existing `SiteExporter` service was refactored to use this same listener instead of the previous `SiteExportFileStorage` class, which has been removed. This consolidates the generic configuration logic into a single reusable event listener. The `SiteExporter` now uses `config.storage.export` and attaches the `GenericConfigurationListener` when exporting sites as recipes.

Test coverage includes functional tests that verify both generic and non-generic exports produce the correct output, checking both config entities and simple configuration objects.

## Timeline

- Opened: December 24, 2025
- Committed: February 11, 2026 (1 month later)

---

*This summary is AI-generated and may contain errors. Check the [original issue on Drupal.org](https://www.drupal.org/node/3564710) for the full picture. For more digests, see [Drupal Digests](https://github.com/dbuytaert/drupal-digests/).*
