# #3573537: Updated method of suppressing the Content menu doesn't work as expected

- **Project:** Drupal CMS
- **Type:** Normal bug report
- **Status:** Fixed
- **Diff:** [1556d3c](https://git.drupalcode.org/project/drupal_cms/-/commit/1556d3cafa8ff17bbd1aadccee805c46967309bb) · +36/-36 prod · +60/-0 test · 12 files
- **Discussion:** [#3573537](https://www.drupal.org/node/3573537) · 2 contributors · 16 comments

## Summary

Drupal CMS was showing unwanted "Create" menu links in the navigation menu for each content type that was added to the site. A previous refactoring had moved the suppression logic from code into configuration files, but this approach made the links reappear for any new content types created after installation. The fix moves the suppression logic back into code as a temporary polyfill until core addresses the underlying usability issues with the navigation menu's "Create" section.

## Impact

No upgrade or configuration changes required.

## Technical details

The Navigation module in Drupal core automatically creates menu links for creating content under a `navigation.create` parent menu item. Drupal CMS previously suppressed these links using `hook_menu_links_discovered_alter()` in the `drupal_cms_helper` module. During a refactoring to consolidate polyfills, this logic was replaced with configuration overrides in recipe files using the `overrideMenuLinks` config action.

The configuration-based approach had a critical limitation: it could only disable specific menu links that existed at the time the recipe was applied. Any content types or media types created after installation would generate new navigation links that were not covered by the configuration, causing them to appear unexpectedly.

The fix restores the original code-based approach by adding `alterDiscoveredMenuLinks()` to the `PluginHooks` class in `drupal_cms_helper`. This hook implementation runs after the Navigation module's own hook (enforced with `OrderAfter(['navigation'])`) and disables all menu links with the `navigation.create` parent, plus the parent link itself. This ensures all current and future "Create" links are suppressed dynamically.

The polyfill includes a `@todo` referencing [#3573730](https://www.drupal.org/project/drupal/issues/3573730) where core will address the underlying usability concerns. All configuration overrides for navigation menu links were removed from the `drupal_cms_admin_ui`, `drupal_cms_content_type_base`, and `drupal_cms_media` recipe files. Test coverage was added to verify that dynamically created content types have their navigation links properly suppressed.

## Timeline

- Opened: February 14, 2026
- Committed: February 18, 2026 (4 days later)

## Collaboration

pameeela reported the issue and advocated strongly for keeping this as a code-based polyfill rather than configuration, making the important point that configuration changes in site templates would be impossible to unwind. phenaproxima implemented the fix and engaged in thoughtful discussion about the tradeoffs between polyfills and explicit UX decisions, ultimately agreeing to restore the code-based approach after confirming the decision over Zoom.

## Lessons learned

- When implementing a temporary fix for an upstream issue, prefer code-based solutions over configuration changes. Code can be removed cleanly when the upstream fix arrives, while configuration changes persist in user sites and require complex update paths to unwind. *(via pameeela, phenaproxima)*
- When the direction of an upstream fix is unclear, avoid assuming your temporary workaround matches the eventual solution. Document the dependency explicitly, but recognize that alignment with the final approach may require later refactoring regardless of implementation strategy. *(via phenaproxima)*

---

*This summary is AI-generated and may contain errors. Check the [original issue on Drupal.org](https://www.drupal.org/node/3573537) for the full picture. For more digests, see [Drupal Digests](https://github.com/dbuytaert/drupal-digests/).*
