# #3562072: Menu link content export with dependencies doesn't include parent menu link entity.

- **Project:** Drupal Core
- **Type:** Normal bug report
- **Version:** 11.3.x-dev
- **Status:** Fixed
- **Diff:** [54bc930](https://git.drupalcode.org/project/drupal/-/commit/54bc9308376895b5e693dcb0a13f6a0249d55336) · +255/-0 prod · +285/-0 test · 9 files
- **Discussion:** [#3562072](https://www.drupal.org/node/3562072) · 4 contributors · 17 comments

## Summary

When using the default content export system to export menu links that have parent menu links, the parent menu links were not being included as dependencies. This meant that exported menu hierarchies would be incomplete, making it difficult to reliably move menu structures between sites. This bug fix ensures that when you export a child menu link with the `--with-dependencies` flag, the parent menu link is automatically included in the export.

## Impact

No upgrade or configuration changes required.

## Technical details

The default content export system provides a `PreExportEvent` that allows modules to add additional dependencies when entities are exported. The `menu_link_content` module was not subscribing to this event, so parent menu link relationships were not being tracked during export.

The fix adds a new `DefaultContentSubscriber` event subscriber to the `menu_link_content` module. The subscriber's `preExport()` method checks if the entity being exported is a `MenuLinkContentInterface` instance and whether it has a parent menu link (identified by the `menu_link_content:` prefix in the parent ID). If a parent exists, it loads the parent entity using `EntityRepositoryInterface::loadEntityByUuid()` and adds it as a dependency via `$event->metadata->addDependency()`.

If the parent cannot be loaded (for example, if it was deleted), the subscriber logs an error to the `default_content` logger channel with the UUIDs of both the parent and child menu links. The service is registered in `menu_link_content.services.yml` with autowiring and autoconfiguration enabled.

## Timeline

- Opened: December 8, 2025
- Committed: February 20, 2026 (2 months later)

## Collaboration

vishalkhode reported this issue and provided the initial implementation. phenaproxima provided thorough review feedback and converted the test from a functional test to a more maintainable kernel test, making it easier to verify the fix. godotislate reviewed the changes and confirmed the test-only failure worked as expected. alexpott committed the fix to three branches.

---

*This summary is AI-generated and may contain errors. Check the [original issue on Drupal.org](https://www.drupal.org/node/3562072) for the full picture. For more digests, see [Drupal Digests](https://github.com/dbuytaert/drupal-digests/).*
