# #3566801: Helper to check if the entity type's ID is integer

- **Project:** Drupal Core
- **Type:** Normal feature request
- **Version:** 11.x-dev
- **Status:** Fixed
- **Diff:** [747ad62](https://git.drupalcode.org/project/drupal/-/commit/747ad627d3659fe9aea504724c1038c9816e148d) · +146/-124 prod · +82/-12 test · 38 files
- **Discussion:** [#3566801](https://www.drupal.org/node/3566801) · 6 contributors · 28 comments

## Summary

Drupal core had repetitive code scattered across many modules to check whether an entity type uses integer IDs. This matters because integer IDs enable routing optimizations and affect how entity references are exported. The new helper method centralizes this logic, making code cleaner and easier to maintain. Three deprecated functions remain temporarily for backward compatibility but will be removed in Drupal 13.

## Impact

Affects module maintainers.

- **New API:** New `EntityTypeInterface::hasIntegerId()` method checks if an entity type uses an integer ID field.

## Technical details

This change adds `EntityTypeInterface::hasIntegerId()` which returns TRUE for integer IDs, FALSE for string IDs, or NULL if the entity type lacks an ID key. The base `EntityType` class returns FALSE (for config entities). `ContentEntityType` inspects the ID field definition to determine the actual type.

The method replaces repeated checks like `$field_definitions[$id_key]->getType() === 'integer'` throughout core. It's used in `DefaultHtmlRouteProvider` for route requirements, `EntityReferenceItem` for property definitions, `Exporter` for default content serialization, and `WorkspaceTracker` for ID field selection.

Three helper methods are deprecated: `_comment_entity_uses_integer_id()`, `DefaultHtmlRouteProvider::getEntityTypeIdKeyType()`, `OverridesSectionStorage::hasIntegerId()`, and `CommentTypeForm::entityTypeSupportsComments()`. The deprecated `getEntityTypeIdKeyType()` method in `DefaultHtmlRouteProvider` remains protected, so only extenders of that class are affected by the deprecation. The comment module function was public but rarely used outside core.

## Upgrade

If you extended `DefaultHtmlRouteProvider` and called its protected `getEntityTypeIdKeyType()` method, replace it with `$entity_type->hasIntegerId()`. If you called the Comment module's `_comment_entity_uses_integer_id()` function, use `\Drupal::entityTypeManager()->getDefinition($entity_type_id)->hasIntegerId()` instead. The deprecated methods will be removed in Drupal 13. See the change record for details: [#3566814](https://www.drupal.org/node/3566814).

## Timeline

- Opened: January 10, 2026
- Committed: February 16, 2026 (1 month later)

## Collaboration

Claudiu Cristea opened this issue as part of the broader effort to eliminate `.module` files and drove the implementation through multiple iterations. Nicxvan and smustgrave discussed the scope and confirmed that despite touching many test files, most changes were simplifications that justified keeping the work together. Berdir provided detailed review feedback and noted the value of having the method available on config entity types too, even though they always return FALSE. Catch committed the change after confirming that the lack of dependency injection was acceptable for now.

## Lessons learned

- When multiple parts of a system perform the same conditional check based on underlying data structure, extract the check into a shared API method on the data structure itself. This centralizes the logic, eliminates duplication, and makes the check discoverable through the type system. *(via claudiu.cristea)*

---

*This summary is AI-generated and may contain errors. Check the [original issue on Drupal.org](https://www.drupal.org/node/3566801) for the full picture. For more digests, see [Drupal Digests](https://github.com/dbuytaert/drupal-digests/).*
