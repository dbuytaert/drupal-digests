# #3554134: Begin cleaning up system install requirements

- **Project:** Drupal Core
- **Type:** Normal task
- **Version:** 11.x-dev
- **Status:** Fixed
- **Diff:** [e4f6bb4](https://git.drupalcode.org/project/drupal/-/commit/e4f6bb432ce8555e38196020e34ea55aebc501d1) · +3228/-2412 prod · +0/-24 infra · 6 files
- **Discussion:** [#3554134](https://www.drupal.org/node/3554134) · 3 contributors · 25 comments

## Summary

Drupal's system requirements checking code was originally written for installation and then copied to handle runtime and update phases. This created a single, very large method with over 1200 lines of code that handled all three phases using conditional logic. This change splits the code into separate classes for each phase, removing logic that doesn't apply to installation from the install requirements class. The result is cleaner, more maintainable code with significantly reduced complexity. This was the single most complex method in Drupal core and is now much easier to understand and modify.

## Impact

No upgrade or configuration changes required.

## Technical details

The `SystemRequirements::checkRequirements()` method previously accepted a `$phase` parameter and contained conditional logic for install, runtime, and update phases. This resulted in the highest cyclomatic complexity of any method in core. The refactoring copies the runtime and update logic into a new `SystemRequirementsHooks` class with a `checkRequirements()` method that handles both phases. The install-specific `SystemRequirements` class now only contains logic for the install phase, with its `checkRequirements()` method no longer accepting a phase parameter. The change removes approximately 1200 lines of conditional logic from the install requirements, including checks for experimental modules, deprecated themes, cron status, configuration file protection, and many other runtime-only concerns. The new `SystemRequirementsHooks` class implements `hook_update_requirements()` and `hook_runtime_requirements()` by calling its internal method. PHPStan baseline entries were also cleaned up as some undefined variable warnings are no longer applicable.

## Timeline

- Opened: October 24, 2025
- Committed: February 18, 2026 (3 months later)

## Collaboration

nicxvan opened the issue and created the initial approach of copying and removing phase-specific code. dcam performed thorough review work across multiple iterations, carefully verifying that runtime and update phase conditions were correctly moved to the new hook class and that only install phase conditions remained in the original class. dcam also conducted manual testing of installation, runtime status reports, and update requirements to ensure functionality remained intact. catch committed the change and noted its impact on the core metrics dashboard for cyclomatic complexity tracking.

---

*This summary is AI-generated and may contain errors. Check the [original issue on Drupal.org](https://www.drupal.org/node/3554134) for the full picture. For more digests, see [Drupal Digests](https://github.com/dbuytaert/drupal-digests/).*
