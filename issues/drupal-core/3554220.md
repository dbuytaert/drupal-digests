# #3554220: Claro's libraries don't enforce the variables.css dependency

- **Project:** Drupal Core
- **Type:** Normal bug report
- **Version:** 11.3.x-dev
- **Status:** Fixed
- **Diff:** [0d04616](https://git.drupalcode.org/project/drupal/-/commit/0d046164d889fbb3de828612b76f7088065fa232) 路 +111/-3 路 3 files
- **Discussion:** [#3554220](https://www.drupal.org/node/3554220) 路 4 contributors 路 20 comments

## Summary

Claro's CSS custom properties (variables) were not loaded when contrib modules used individual Claro libraries like `claro/claro.drupal.dialog` or `claro/claro.jquery.ui` without loading the full theme. This caused broken styling when modules like `gin_toolbar` tried to use Claro components on non-Claro front-end themes. CSS rules that referenced variables like `--jui-dropdown-fg-color` or `--input-border-radius-size` failed to resolve, resulting in elements with missing colors, borders, and shadows.

## Impact

No upgrade or configuration changes required.

## Technical details

Claro's `css/base/variables.css` file defines CSS custom properties used throughout the theme's component stylesheets. Previously, this file was only loaded as part of the `claro/global-styling` library. When contrib modules referenced individual Claro libraries like `claro/claro.jquery.ui` or `claro/claro.drupal.dialog`, those components would load but their CSS custom property references would fail because `variables.css` wasn't loaded.

The fix creates a new `claro/variables` library definition containing only `css/base/variables.css`. This file is removed from `claro/global-styling` and instead added as a dependency to `global-styling` and to all 19 other Claro libraries that reference CSS custom properties. These include `claro.jquery.ui`, `claro.drupal.dialog`, `drupal.tablesort`, `system.admin`, `icon-link`, `drupal.shortcut`, `status.report`, `views`, `views_ui`, `card`, `file`, `media_library.theme`, `media_library.ui`, `progress`, `filter`, `form-two-columns`, and `image.admin`.

This approach allows individual Claro components to be used independently while ensuring the CSS variables they depend on are always available. The change is non-disruptive because the variables are still loaded in the same order for sites using the full Claro theme.

## Timeline

- Opened: October 24, 2025
- Committed: February 12, 2026 (3 months later)

## Collaboration

codebymikey identified the issue when using `gin_toolbar` with non-Claro themes and created the fix. They systematically audited all Claro CSS files to identify which libraries needed the variables dependency. smustgrave reviewed the change and confirmed it was non-disruptive. longwave committed the fix and backported it to Drupal 11.3.x as an eligible bug fix.

## Lessons learned

- When creating reusable component libraries that use CSS custom properties (variables), expose the variables as a separate library dependency. Components that reference variables will fail silently if the variables aren't defined, causing broken styling when the component is used in isolation. *(via codebymikey)*

---

*This summary is AI-generated and may contain errors. Check the [original issue on Drupal.org](https://www.drupal.org/node/3554220) for the full picture. For more digests, see [Drupal Digests](https://github.com/dbuytaert/drupal-digests/).*
