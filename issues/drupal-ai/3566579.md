# #3566579: Add Field Widget Actions (FWA) support for core Image field using llm_image_generation

- **Project:** Drupal AI
- **Type:** Normal feature request
- **Version:** 1.3.x-dev
- **Status:** Fixed
- **Diff:** [93d25c1](https://git.drupalcode.org/project/ai/-/commit/93d25c10ad41832d467a3d80505847f8a36ff3c0) 路 +356/-0 路 4 files
- **Discussion:** [#3566579](https://www.drupal.org/node/3566579) 路 5 contributors 路 18 comments

## Summary

The AI module now lets editors generate images from text prompts directly within image fields on content forms. When editing an article or other content, a button appears next to image fields that can trigger AI image generation based on text from other fields like the title or body. This makes it faster to illustrate content without leaving the editing screen or manually uploading files. Site administrators can configure which text fields provide the prompt and customize the instructions sent to the AI provider.

## Impact

No upgrade or configuration changes required.

## Technical details

This feature adds a new Field Widget Action plugin called `TextToImage` that integrates the `llm_image_generation` automator with Drupal's core image field widget. The plugin extends `AutomatorBaseAction` and registers itself for the `image_image` widget type using the `#[FieldWidgetAction]` attribute.

The `aiAutomatorsAjax()` method handles the AJAX callback when editors click the generate button. It extracts the field name and delta from the triggering element, then calls `populateAutomatorValues()` to execute the automator and update the form state. The `saveFormValues()` method handles the complex task of properly setting the generated image file on the managed file widget by updating the `fids` array and any alt/title metadata.

The implementation follows the existing `Email.php` plugin pattern mentioned in the issue description. Configuration happens through the field settings UI where administrators can choose between Base Mode (using a single text field with `{{ context }}` placeholder) or Advanced Mode (using Drupal tokens to construct prompts from multiple fields).

A new documentation file at `docs/modules/ai_automators/text_to_image_automator.md` provides complete setup instructions including prerequisites, configuration steps for both modes, and testing procedures.

## Timeline

- Opened: January 9, 2026
- Committed: February 11, 2026 (1 month later)

## Collaboration

Anjaliprasannan implemented the initial Field Widget Action plugin and documentation. Prabha1997 tested the functionality and confirmed it worked as expected. A.dmitriiev provided the code review and requested documentation be added to help users configure the automator, then merged the changes to both the 1.3.x and 2.0.x branches after the documentation was complete.

---

*This summary is AI-generated and may contain errors. Check the [original issue on Drupal.org](https://www.drupal.org/node/3566579) for the full picture. For more digests, see [Drupal Digests](https://github.com/dbuytaert/drupal-digests/).*
