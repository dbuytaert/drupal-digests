# #3566579: Add Field Widget Actions (FWA) support for core Image field using llm_image_generation

- **Project:** Drupal AI
- **Type:** Normal feature request
- **Version:** 1.3.x-dev
- **Status:** Fixed
- **Diff:** [93d25c1](https://git.drupalcode.org/project/ai/-/commit/93d25c10ad41832d467a3d80505847f8a36ff3c0) 路 +356/-0 路 4 files
- **Discussion:** [#3566579](https://www.drupal.org/node/3566579) 路 5 contributors 路 17 comments

## Summary

Content editors can now generate images directly from text prompts within the Image field widget during content creation. This eliminates the need to switch to external AI image generation tools and manually upload results. Configure an AI Automator on any Image field with a text-to-image provider like DALL-E or Stability AI, then use the "AI Automator" button in the field widget to generate and attach images based on prompts from other fields.

## Impact

No upgrade or configuration changes required.

## Technical details

The AI Automators module now includes a `TextToImage` Field Widget Action plugin that integrates text-to-image generation into core Image field widgets. The plugin extends `AutomatorBaseAction` and registers itself for the `image_image` widget type and `image` field type using the `#[FieldWidgetAction]` attribute.

The `aiAutomatorsAjax()` method handles AJAX requests triggered by the widget button. It extracts the field name and delta from the triggering element, then calls `populateAutomatorValues()` to execute the configured `llm_image_generation` automator and populate the entity field with the generated image file.

The `saveFormValues()` method updates the form element structure to reflect the newly generated image. It sets the `#value` array with file IDs (`fids`) on the managed file widget elements and updates alt and title properties if present. This ensures the generated image appears immediately in the widget after AJAX completion.

Documentation added in `text_to_image_automator.md` explains two configuration modes: Base Mode uses a single text field with `{{ context }}` placeholder replacement, while Advanced Mode supports full Drupal token syntax for complex prompt construction from multiple fields.

## Timeline

- Opened: January 9, 2026
- Committed: February 11, 2026 (1 month later)

## Collaboration

The contributor anjaliprasannan implemented the feature, prabha1997 provided testing and feedback, and maintainer a.dmitriiev requested documentation before merging. The documentation requirement after code approval demonstrates a helpful pattern: treating user-facing instructions as equally important as code quality, ensuring features ship with clear guidance for adoption.

---

*This summary is AI-generated and may contain errors. Check the [original issue on Drupal.org](https://www.drupal.org/node/3566579) for the full picture. For more digests, see [Drupal Digests](https://github.com/dbuytaert/drupal-digests/).*
