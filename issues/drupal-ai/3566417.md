# #3566417: Extend Media Library with description and tag filters

- **Project:** Drupal AI
- **Type:** Normal feature request
- **Version:** 1.x-dev
- **Status:** Fixed
- **Diff:** [9adf1a8](https://git.drupalcode.org/project/ai_recipe_image_classification/-/commit/9adf1a85f4cf59181652255c853431e41b5c16c4) 路 +220/-2 路 4 files
- **Discussion:** [#3566417](https://www.drupal.org/node/3566417) 路 4 contributors 路 16 comments

## Summary

The AI Recipe Image Classification now adds search filters to the Media Library, making it easier to find images by their AI-generated descriptions and classification tags. These filters appear in both the media overview page and the media selection widget, so editors can quickly locate images based on their content. This improvement helps sites with large media libraries where manually browsing through images is time-consuming.

## Impact

Affects site owners.

- **Requirements:** Minimum Drupal core version raised from 10.4/11.0 to 11.2

## Technical details

This recipe now extends the `media` and `media_library` views by adding two exposed filters using the `setProperties` config action. The description filter uses the `string` plugin on `field_image_description_value` with an "all words" operator. The tags filter uses the `taxonomy_index_tid` plugin on `field_image_tags_target_id` configured as a textfield with multiple selection enabled.

The recipe adds these filters to all displays in both views: the default display, page display, widget display, and widget_table display. The YAML uses anchors and aliases to avoid repetition of the filter configuration across displays.

This implementation requires the `setProperties` config action which was introduced in Drupal 11.2. Earlier approaches like `simpleConfigUpdate` are deprecated for configuration entities, and alternative config actions either don't support nested paths or can't control filter ordering. The minimum core requirement was raised from 10.4/11.0 to 11.2 to use this action reliably.

## Upgrade

Sites must be running Drupal 11.2 or later before updating this recipe to version 2.0.0. The `composer.json` requirement changed from `^10.4 || ^11` to `^11.2`.

## Timeline

- Opened: January 8, 2026
- Committed: February 12, 2026 (1 month later)

## Collaboration

fago led the implementation work, evaluating multiple technical approaches before settling on the `setProperties` config action solution. They documented the tradeoffs between different config action methods and their limitations, ultimately choosing the path that requires Drupal 11.2+ but provides maintainable code. a.dmitriiev opened the issue identifying the need for better image search capabilities.

## Lessons learned

- When modifying Views configuration in recipes, config actions that support nested paths (like setProperties) allow surgical updates to specific filters without duplicating large config structures. Actions without nested path support force you to re-set entire configuration blocks, creating maintenance burden. *(via fago)*
- When recipes need to modify configuration that core or distributions install earlier, there's no way to force-overwrite existing config. Solutions that only work on fresh installs don't help users applying recipes to existing sites, so require alternative approaches like config actions or version bumps. *(via fago)*

---

*This summary is AI-generated and may contain errors. Check the [original issue on Drupal.org](https://www.drupal.org/node/3566417) for the full picture. For more digests, see [Drupal Digests](https://github.com/dbuytaert/drupal-digests/).*
