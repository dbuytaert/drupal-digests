# #3518356: Add Full screen and Expand options to Deepchat chatbot

- **Project:** Drupal AI
- **Type:** Normal feature request
- **Version:** 2.0.x-dev
- **Status:** Fixed
- **Diff:** [15454aa](https://git.drupalcode.org/project/ai/-/commit/15454aa9c2e59e32c396c8438f19c4681da164bf) 路 +250/-12 路 10 files
- **Discussion:** [#3518356](https://www.drupal.org/node/3518356) 路 12 contributors 路 33 comments

## Summary

The AI Chatbot block now offers two ways to make the chatbot easier to read and use when placed in the toolbar. Editors can enable an "Expand" mode that widens the chatbot sidebar, or a "Full screen" mode that opens the chatbot in a modal overlay. Both options are configurable in the block settings, giving site builders control over how users interact with the chatbot interface. The expanded or fullscreen state resets when the chatbot is closed.

## Impact

No upgrade or configuration changes required.

## Technical details

The `DeepChatFormBlock` plugin now includes an `expansion_method` configuration option with three values: `none`, `expand`, and `fullscreen`. This setting is only visible when the chatbot placement is set to `toolbar`. The `expand` option uses a CSS custom property `--toolbar-chatbot-expand-amount` set to `20rem` when the `ai-chatbot-expanded` class is added to the body element. This pushes page content to the right and recalculates `--drupal-displace-offset-left` and `--admin-toolbar-sidebar-width` to accommodate the wider chatbot.

The `fullscreen` mode conditionally loads a new `toolbar-fullscreen` library that applies modal styling using a backdrop overlay and fade-in/fade-out animations. The implementation uses CSS animations rather than a dialog API to preserve chatbot state across transitions. JavaScript in `toolbar-chatbot.js` handles the `expand` button click events, toggling body classes and `aria-expanded` attributes. The fullscreen exit animation uses `animationend` listeners with double `requestAnimationFrame` callbacks to ensure clean removal of animation classes after the transition completes.

An Escape key handler exits fullscreen mode. The close button now resets both expand and fullscreen states before closing the chatbot. New SVG icons for expand, collapse, and caret-right were added, with `collapse.svg` updated to use `currentColor` instead of a hardcoded stroke color.

## Timeline

- Opened: April 10, 2025
- Committed: February 19, 2026 (10 months later)

## Collaboration

bbruno implemented the feature based on design wireframes discussed in AI UX/UI meetings, iterating through multiple rounds of feedback. petar_basic provided detailed code review suggestions on the merge request that improved the implementation structure. ahmad khader performed thorough testing across all three expansion modes and identified edge cases around state cleanup and parameter handling, leading to further refinements. rajeshreeputra and davidbp made their first commits to the AI module through this issue, gaining experience with the codebase.

---

*This summary is AI-generated and may contain errors. Check the [original issue on Drupal.org](https://www.drupal.org/node/3518356) for the full picture. For more digests, see [Drupal Digests](https://github.com/dbuytaert/drupal-digests/).*
