# #3518356: Add Full screen and Expand options to Deepchat chatbot

- **Project:** Drupal AI
- **Type:** Normal feature request
- **Version:** 2.0.x-dev
- **Status:** Fixed
- **Diff:** [15454aa](https://git.drupalcode.org/project/ai/-/commit/15454aa9c2e59e32c396c8438f19c4681da164bf) 路 +250/-12 路 10 files
- **Discussion:** [#3518356](https://www.drupal.org/node/3518356) 路 12 contributors 路 34 comments

## Summary

The AI Chatbot module's toolbar chatbot can now expand to give users more room to read and interact with conversations. Editors can choose between three expansion options in the block settings: none (no expansion), expand (widens the sidebar and pushes page content to the right), or fullscreen (opens the chat in a modal overlay). The fullscreen mode includes a backdrop, smooth fade animations, and can be closed with the Escape key. These options help users who need more space than the default sidebar provides, improving readability and usability for longer conversations.

## Impact

No upgrade or configuration changes required.

## Technical details

The `DeepChatFormBlock` plugin now includes an `expansion_method` configuration field with three options: `none`, `expand`, and `fullscreen`. This field is only visible when the chatbot placement is set to `toolbar`. The expand button appears in the sidebar header when `expansion_method` is not `none`, using different icons and behaviors depending on the selected mode.

In expand mode, clicking the button toggles the `ai-chatbot-expanded` class on the body element. CSS custom properties (`--toolbar-chatbot-expand-amount` set to 20rem) drive width calculations for the chatbot, toolbar, and displaced page content. The caret icon rotates 180 degrees to indicate the expanded state.

In fullscreen mode, clicking the button triggers `enterFullscreen()` and `exitFullscreen()` functions in `toolbar-chatbot.js`. The `ai-chatbot-fullscreen` class is added to the body, and the block wrapper receives fade-in/fade-out animations. The fullscreen library (`toolbar-fullscreen.css`) is conditionally attached only when `expansion_method` equals `fullscreen`. The chatbot is positioned as a fixed overlay with a semi-transparent backdrop. Exit animations use `animationend` events with double `requestAnimationFrame` calls to ensure clean transitions before removing classes and resetting state.

Both expansion states are reset when the close button is clicked. The Escape key handler also exits fullscreen mode. ARIA attributes (`aria-expanded`, `aria-label`) are maintained for accessibility. The expand button stores its mode in a `data-expansion-method` attribute read by the JavaScript.

## Timeline

- Opened: April 10, 2025
- Committed: February 19, 2026 (10 months later)

## Collaboration

bbruno opened the issue, implemented the feature through multiple iterations, and responded quickly to detailed review feedback. ahmad khader provided a thorough technical review in comment #21, identifying edge cases like unused function parameters and inconsistent state cleanup between modes, along with accessibility and CSS architecture observations. petar_basic reviewed the MR multiple times (comments #16 and #26), providing detailed suggestions and confirming that fixes addressed the feedback correctly. rajeshreeputra and davidbp made their first commits to the issue fork. The issue benefited from thoughtful UX discussion about whether expand state should persist, deferred to a future issue.

---

*This summary is AI-generated and may contain errors. Check the [original issue on Drupal.org](https://www.drupal.org/node/3518356) for the full picture. For more digests, see [Drupal Digests](https://github.com/dbuytaert/drupal-digests/).*
