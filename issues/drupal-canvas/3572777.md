# #3572777: PHPCS: require `declare(strict_types=1);`

- **Project:** Drupal Canvas
- **Type:** Normal task
- **Version:** 1.x-dev
- **Status:** Fixed
- **Diff:** [50f9b9b](https://git.drupalcode.org/project/canvas/-/commit/50f9b9b6d5b55bb04128d80c5864536756c3266b) · +75/-16 prod · +9/-0 infra · 46 files
- **Discussion:** [#3572777](https://www.drupal.org/node/3572777) · 2 contributors · 9 comments

## Summary

PHP strict type declarations are now required in all Canvas module PHP files and automatically enforced by PHPCS. This catches type-related bugs earlier during code review by failing the automated checks when the `declare(strict_types=1);` statement is missing or incorrectly formatted. The automated check prevents code from being merged without proper type declarations, which previously required manual reminders during merge request reviews.

## Impact

No upgrade or configuration changes required.

## Technical details

The Canvas project added the `SlevomatCodingStandard.TypeHints.DeclareStrictTypes` rule to `phpcs.xml` to require `declare(strict_types=1);` at the top of every PHP file. The rule is configured with `spacesCountAroundEqualsSign` set to 0 to enforce `strict_types=1` instead of `strict_types = 1`. The rule excludes `.api.php` files, test fixtures in `tests/fixtures/update/*`, and the `canvas_ai` module which is not yet held to the same standards.

The diff adds `declare(strict_types=1);` to 47 files that were missing it and corrects the formatting in 13 files that had spaces around the equals sign (changing `declare(strict_types = 1);` to `declare(strict_types=1);`).

Enabling strict types immediately revealed a type mismatch bug in `UnixTimestampToDateAdapter`. The `$unix` property was typed as `string` but received an `int` value. The fix changed the property type to `int` and added an explicit cast to string when passing to `\DateTime::createFromFormat()`, which expects a string parameter.

## Timeline

- Opened: February 11, 2026
- Committed: February 11, 2026

## Collaboration

Wim Leers opened the issue after repeatedly providing the same feedback in merge request reviews. Automating the check immediately caught a type bug during implementation that would have caused runtime errors, demonstrating the value of enforcing strict types project-wide. This pattern of converting recurring manual review feedback into automated checks saves reviewer time and catches errors earlier.

---

*This summary is AI-generated and may contain errors. Check the [original issue on Drupal.org](https://www.drupal.org/node/3572777) for the full picture. For more digests, see [Drupal Digests](https://github.com/dbuytaert/drupal-digests/).*
