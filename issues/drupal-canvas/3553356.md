# #3553356: Allow @plugins support in Global CSS

- **Project:** Drupal Canvas
- **Type:** Normal feature request
- **Version:** 1.x-dev
- **Status:** Fixed
- **Diff:** [c858ee8](https://git.drupalcode.org/project/canvas/-/commit/c858ee8cc235922c5c327792f38475debe8dfdde) · +136/-58 prod · +3/-0 test · 14 files
- **Discussion:** [#3553356](https://www.drupal.org/node/3553356) · 7 contributors · 15 comments

## Summary

Drupal Canvas now supports Tailwind CSS plugins in Global CSS, allowing design teams to use popular plugins like `@tailwindcss/typography` for rich text styling, `tailwindcss-animate` for animations, and others. The `@tailwindcss/typography` plugin is bundled by default. This makes it easier to build production-grade design systems within Canvas without needing to modify the build process manually.

## Impact

No upgrade or configuration changes required.

## Technical details

Canvas previously compiled Tailwind CSS without support for plugins, limiting the ability to extend Tailwind with community tools. This change upgrades the `tailwindcss-in-browser` library from version 0.5.0 to 0.6.0, which adds support for loading Tailwind CSS plugins via the native JavaScript `import()` function.

The new `GlobalImports` service centralizes the import map for Canvas, defining which JavaScript modules are available to components. The `@tailwindcss/typography` plugin is now bundled and added to this import map, making it immediately available in Global CSS via the `@plugin "@tailwindcss/typography"` directive.

Plugins can be referenced in two ways: by bare specifier (like `@plugin "@tailwindcss/typography"`) if they appear in the import map, or by full URL (like `@plugin "https://esm.sh/tailwindcss-animate"`). The URL approach works in the browser but will fail in local React codebases using Canvas CLI because Node.js does not support remote HTTP imports natively.

The import map rendering was moved from `JsComponent::renderComponent()` to `CanvasController` to ensure plugins are available across the entire Canvas UI, not just individual components. The `GlobalImports` service handles cache-busting query strings using the module version or asset query string service.

## Timeline

- Opened: October 20, 2025
- Committed: February 10, 2026 (3 months later)

## Collaboration

The issue involved collaboration across seven contributors over nearly four months. wotnak drove the implementation by first creating the upstream pull request in the `tailwindcss-in-browser` library, then implementing the Canvas integration and providing detailed documentation about both URL-based and import-map-based plugin loading approaches. balintbrews guided the scope refinement, helping narrow the initial broad proposal to a focused incremental step. mayur-sose provided comprehensive test coverage including edge cases like plugin conflicts and invalid plugin handling. This pattern of contributing upstream dependencies first, then integrating them with clear documentation about limitations, helped maintain compatibility across both browser and CLI environments.

## Lessons learned

- When integrating JavaScript runtime APIs (like native import()) across browser and Node.js environments, differences in protocol support can silently break one environment. If the browser supports HTTPS imports but Node.js doesn't, explicitly restrict the feature or provide environment-specific alternatives to maintain compatibility across all deployment contexts. *(via wotnak)*

---

*This summary is AI-generated and may contain errors. Check the [original issue on Drupal.org](https://www.drupal.org/node/3553356) for the full picture. For more digests, see [Drupal Digests](https://github.com/dbuytaert/drupal-digests/).*
